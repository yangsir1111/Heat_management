# 🍎 智能热量管理系统

基于React和通义千问VL-Plus模型的食物热量识别与健康管理应用。

## 🚀 功能特点

- 📸 **食物识别**：通过拍照或上传图片识别食物名称、热量和营养成分
- 📊 **健康数据统计**：记录每日热量摄入，生成趋势图表
- 💡 **健康建议**：根据食物分析提供个性化健康建议
- 💾 **本地存储**：所有数据保存在浏览器本地，保护用户隐私
- 🎨 **精美UI**：现代化界面设计，流畅的用户体验

## 🛠 技术栈

- **前端**：React, TypeScript, Vite, TailwindCSS, Chart.js
- **后端**：Node.js, Express
- **AI模型**：通义千问VL-Plus (阿里云)

## 📋 快速开始

### 1. 环境准备

确保您的计算机已安装以下软件：
- [Node.js](https://nodejs.org/) (v16或更高版本)
- [npm](https://www.npmjs.com/) (通常与Node.js一起安装)

### 2. 克隆项目

```bash
# 克隆项目代码
git clone <项目地址>
cd Heat_management
```

### 3. 配置API密钥

在项目根目录创建`.env`文件，并添加您的通义千问API密钥：

```env
# .env文件内容
DASHSCOPE_API_KEY=您的API密钥
```

> 提示：如果没有API密钥，可以在[阿里云官网](https://www.aliyun.com/)申请通义千问API服务。

### 4. 安装依赖

```bash
npm install
```

### 5. 启动开发服务器

```bash
npm run dev:full
```

这个命令会同时启动：
- 前端开发服务器 (http://localhost:5173)
- 后端API服务器 (http://localhost:3001)

## 🚦 测试指南

### 1. 完整系统测试

1. 打开浏览器，访问 http://localhost:5173
2. 点击"拍照"或"上传照片"按钮选择食物图片
3. 等待AI分析完成
4. 查看识别结果和营养信息
5. 在个人页面查看历史记录和统计数据

### 2. API测试工具

项目包含一个专门的测试脚本，用于验证AI服务是否正常工作：

```bash
# 基本测试（需要准备test-image.jpg图片）
node test-ai.js

# 模拟测试（不需要实际图片）
node test-ai.js --simulate
```

## 🔧 项目结构

```
├── src/                 # 前端源码
│   ├── components/      # React组件
│   ├── services/        # 服务层（AI服务、存储服务）
│   ├── types/           # TypeScript类型定义
│   ├── App.tsx          # 应用入口组件
│   └── main.tsx         # 应用主文件
├── server.js            # 后端服务器
├── test-ai.js           # AI服务测试脚本
├── package.json         # 项目配置和依赖
└── .env                 # 环境变量配置（需自行创建）
```

## 📝 功能说明

### 1. 食物识别页面

- **拍照功能**：直接调用设备摄像头拍摄食物
- **图片上传**：从本地选择食物图片
- **AI识别**：上传后自动调用通义千问VL-Plus模型进行分析
- **结果展示**：显示食物名称、热量、营养成分和健康建议
- **错误处理**：提供友好的错误提示和重试选项

### 2. 健康数据页面

- **数据统计**：查看今日、近7天、近30天的热量摄入情况
- **趋势图表**：可视化展示热量摄入趋势
- **详情查看**：点击查看今日摄入的详细记录
- **目标管理**：显示与每日建议摄入量的对比

### 3. AI服务

- **图片压缩**：自动压缩图片以提高上传速度
- **Base64转换**：将图片转换为API可接受的格式
- **错误处理**：完善的异常捕获和错误提示

### 4. 本地存储

- **记录保存**：自动保存识别结果到localStorage
- **数据查询**：支持按日期范围查询记录
- **统计计算**：自动计算每日热量总和

## ⚠️ 注意事项

1. **API密钥安全**：请妥善保管您的API密钥，不要将其提交到代码仓库
2. **识别准确性**：AI识别结果为估算值，仅供参考
3. **网络要求**：使用时需要保持网络连接，以便调用AI服务
4. **性能优化**：大图片可能需要较长时间处理，建议使用清晰且适当大小的图片

## 🔄 常见问题

### 1. 服务器启动失败

- 检查端口是否被占用
- 确认API密钥是否正确配置

### 2. 图片识别失败

- 确保图片清晰，食物主体突出
- 检查网络连接是否正常
- 验证API密钥是否有效

### 3. 数据未保存

- 确认浏览器是否支持localStorage
- 检查浏览器隐私设置，确保未禁用存储功能

## 🤝 贡献指南

欢迎提交Issue和Pull Request来帮助改进这个项目！

## 📄 许可证

[MIT License](LICENSE)

## 🙏 致谢

- 阿里云通义千问团队提供的AI模型支持
- 所有为这个项目做出贡献的开发者

---

祝您使用愉快！健康饮食，从智能识别开始！ 💪